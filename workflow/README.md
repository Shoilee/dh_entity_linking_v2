[edit](https://drive.google.com/file/d/16X1PiVgtSVrZNMkEIWW3eY17JztUH5w4/view?usp=sharing)




# Data 
1. [Bronbeek](https://surfdrive.surf.nl/files/index.php/f/14408030395) (format: csv)
2. [NMVW](https://surfdrive.surf.nl/files/index.php/apps/files/?dir=/Shared/Work%20Package%201B/data/linkedart_nmvw_data/ccrdfconst&fileid=12458101919) (format: rdf/ttl)



## Data Conversion
[convert_csv2rdf](convert_csv2rdf.py) script convert csv files into nq files based on the conversion metadata specifciations of the csv files in folder [conversion_metadata](conversion_metadata). 
- To run this script you need to provide path-to-directory where your csv and metadata is stored.
> Note: convert_csv2rdf.convert_csv_to_rdf() expects your csv and conversion metadata json file is in the same folder.


## Data Enrichment
Linked data enrichment with the [enrich_data_bronbeek](enrich_data_bronbeek) script to add provenance activity (i.e., acqusition events, former owner and objects related to person.)

```bash
python enrich_data_bronbeek.py <folder-path-of-all-nq-files>
```
> [enrich_data_bronbeek.py](enrich_data_bronbeek.py) expects .nq files.


# Linking

[All the experiment and the algorithm used can be found here](https://github.com/Shoilee/actor_linking)


# Upload
- Upload Bronbeek data
- Upload Bronbeek enriched
- Upload NMVW data
- Upload person-person links
- Upload ontologies (CIDOC, rdfs, etc)
## Upload to cliopatria

1. compress the .nq files with bash command
   ```bash
   gzip <path-to-folder>/*.nq
   ```

2. from cliopatria CLI, type
   ```
    rdf_library:rdf_attach_library(<path-directory-where-voild.ttl>).
    e.g., 
    rdf_library:rdf_attach_library("/Users/sarah_shoilee/Desktop/Sarah.nosync/Bronbeek_Data/csv_dump/LD").
    rdf_library:rdf_load_library('bronbeek')
    rdf_library:rdf_load_library('bronbeek-enriched')
   ```
> Note: [void.ttl](void.ttl) expects triple files are in the same folder as void.ttl.
3. upload nmvw ccrdfconst and ccrdfacqusiition.
   ```bash 
   rdf_library:rdf_attach_library("/Users/sarah_shoilee/PycharmProjects/entity_linking/nmvw_data/ccrdfconst").
    rdf_library:rdf_load_library('nmvw-ccrdfconst')
   
   ```

   ```bash 
   rdf_library:rdf_attach_library("/Users/sarah_shoilee/PycharmProjects/entity_linking/nmvw_data/ccrdfobjacquisition").
    rdf_library:rdf_load_library('nmvw-ccrdfobjacquisition')
   
   ```
4. upload links among constituents among two different institues generated by algorithms.


## SPARQL Queries


| ID    | CQs from Previous Paper   | Alternate CQs  Answers(v1)   |SPARQL Query   |  Alternate CQs  Answers(v2)   | SPARQL Query  |
| ----- | --------------------------| ------------------------ | ------------------------ | -------------- | -------------- |
| CQ-1  | Which persons were involved in the provenance of this object? | Is there any person involved in the provenance of this object with colonial background? |   | How many object's provenance has collection with connection with colonial context?        |  |
| CQ-1b |                                                               | Is there a possible relation between objects that are linked to a same person?     |                     ```SPARQL<br><br>PREFIX skos: <http://www.w3.org/2004/02/skos/core#><br><br>PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#><br><br>PREFIX owl: <http://www.w3.org/2002/07/owl#><br><br>PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/><br><br>  <br><br>SELECT ?name ?constituentID ?conxrefdetailID ?conxrefID ?object_bronbeek ?nmvw_constituent ?event ?nmvw_object<br><br>WHERE{<br><br>?constituentID <https://example.com/Bronbeek/Constituents/vocab/DisplayName> ?name .<br><br>?conxrefdetailID <https://example.com/ConXrefDetails/vocab/ConstituentID> ?constituentID .<br><br>?conxrefdetailID <https://example.com/ConXrefDetails/vocab/ConXrefID> ?conxrefID .<br><br>?conxrefID skos:related ?object_bronbeek .<br><br>?nmvw_constituent owl:sameAs ?constituentID .<br><br>?event ?p ?nmvw_constituent .<br><br>?nmvw_object ?p1 ?event .<br><br>?nmvw_object a crm:E22_Human-Made_Object .<br><br>} LIMIT 100<br><br>  <br><br>```| How many objects per person connected with on average?       |                     |
| CQ-2  | Which objects are collected by person A?        | Which objects are collected by person(s) with colonial history?                 |                             |    How objects are collected by person(s) with colonial history?     |                            |
| CQ-3  | Is there a relationship between person A and person B ?                              | Is there a relationship between person A and person B through object collection event?                |               | How many pair of people can be linked together?                       |                  |
| CQ-4  | Which objects were collected in this geographical location?                         | Which objects were collected in this geographical location from both dataset?                         |                   | How many objects are on average (potenially) from each geographic location?           |                  |
| CQ-5  | Which objects were collected during this event?                                     | Which objects were collected during this historical  event?                      |                                      | only If you can define the event with specific time and place? We do not need to put the historical events in the data for that.    |       |
| CQ-6  | Which objects were collected in this geographical location during this time period? | Which objects were potentially collected in this geographical location during this time period from both dataset?       | ```<br>PREFIX skos: <http://www.w3.org/2004/02/skos/core#><br>PREFIX owl: <http://www.w3.org/2002/07/owl#><br><br>SELECT *<br>WHERE{<br>  # ?s ?p ?nmvw_uri .<br>  ?nmvw_uri owl:sameAs <https://example.com/Constituents/7329> .<br>  ?conxrefDetails <https://example.com/ConXrefDetails/vocab/ConstituentID> <https://example.com/Constituents/7329> .<br>  ?conxrefDetails <https://example.com/ConXrefDetails/vocab/ConXrefID> ?conxref .<br>  ?conxref skos:related ?bronbeek_object .<br>}<br>``` |                 |                  |
|       |        |          |                 |        |                 |


### Result Table 

| CQ        | Competency Question                                                                 | Alternate CQ that adds information                                                                                                                                              | CQ IR Before Links                                                                                                                                                                                                              | CQ IR After Links                                                                                                                                                                                    | Remarks                                                                                                                                                                                                                             | Count Before Link                                                      | Count after link (exact string match:351 Links)                                         | Count after link (initial + surname match: 978 links)                                                                                          | Count after link (surname match: 51376)                                                       | Count after link (Fuzzy match) | Count after link (Deezy match) |
| --------- | ----------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------- | --------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------- | ------------------------------ | ------------------------------ |
| CQ-1      | Which persons were involved in the provenance of this object?                       | Which persons were involved in the provenance of this objects and have military background?                                                                                     | How many actors we have with one more objects and also have military background?                                                                                                                                                |                                                                                                                                                                                                      | Note that, in SPARQL query, we also considered `production actor`                                                                                                                                                                   | 0                                                                      | 117                                                                                     | 277                                                                                                                                            | 2,680                                                                                         |                                |                                |
| CQ-1b     |                                                                                     | How many object could have possible relation as they are collected by same actor?                                                                                               | How many objects has links with at least another object, based on the fact that they are collected by same person?                                                                                                              |                                                                                                                                                                                                      | Note that, here we considered all the objects connection from NMVW and the bronbeek object connection when actor has owl:sameAs Link. In other words, we did not take into consider object to object connection from Bronbeek side. | 444,517                                                                | 707 / 445,221                                                                           | 2153 / 446,670                                                                                                                                 | 94,298 / 538,815                                                                              |                                |                                |
| ~~CQ-1c~~ |                                                                                     |                                                                                                                                                                                 | ~~How many object to object connection we have, by establishing links via actor? (> remarks, we can remove it, if it is not meaning full.)~~                                                                                    |                                                                                                                                                                                                      |                                                                                                                                                                                                                                     | ~~2,918,004,358~~                                                      |                                                                                         | ~~2,918,355,472~~                                                                                                                              |                                                                                               |                                |                                |
| CQ-2      | Which objects are collected by person A?                                            | Which objects are collected by person(s) with miltary background?                                                                                                               | How many objects are collected by person(s) with miltary background?                                                                                                                                                            |                                                                                                                                                                                                      | Note that, in SPARQL query, we also considered `production actor`; so it does not truly reflect `collected by`                                                                                                                      | 0                                                                      | 5,569                                                                                   | 18,551                                                                                                                                         | 114,177                                                                                       |                                |                                |
| CQ-3      | Is there a relationship between person A and person B?                              | Is there a relationship between person A and person B through object collection event?                                                                                          | How many pair of actors can be linked via same objects acquisition event(s)?                                                                                                                                                    |                                                                                                                                                                                                      | Note that, in SPARQL query, we did not consider `production actor`; so it does not truly reflect `collected by`                                                                                                                     | 3878                                                                   | 3878 (0 new links)                                                                      | 3888 (10 new links)                                                                                                                            | 4,853 (975 new links)                                                                         |                                |                                |
| CQ-4      | Which objects were collected in this geo- graphical location?                       | If the objects production location is not known, for how many objects we can project potential geographic location?                                                             | Number of objects that are connected to actors where at least one object per actor, we know their production location.                                                                                                          | Number of objects that are connected to actors where at least one object per actor, we know their production location. These includes actors who appears also in Bronbeek dataset and their objects. |                                                                                                                                                                                                                                     | 45,756                                                                 | 45,756 (0 new objects)                                                                  | 1841 (47,597)                                                                                                                                  | 12776 ()new objects (when there is multiple match on the bb actor, only kept the first match) |                                |                                |
| CQ-5      | Which objects were collected during this (historical) event?                        | Which object may have connection with historical event, based on the fact that, they are connected with some actors, whose other object(s) has connection with historical event | How many objects has connection with historical event?                                                                                                                                                                          |                                                                                                                                                                                                      | Note that, the projection of historical event is not done for NMVW dataset                                                                                                                                                          | 13,359 has connection with event at least one event; 261.941 per event | 13,379 ; 20 (new object connected to the actor who have connection to historical event) | 13,671 ; 312 (new object connected to the actor who have connection to historical event)                                                       | 14,278 / 912                                                                                  |                                |                                |
| CQ-6a     | Which objects were collected in this geographical location during this time period? | Which objects were collected in this geographical location during this time period from both dataset?                                                                           | How many objects can be connected with one other objects based on they are collected during similar time, by the same actor?                                                                                                    | How many more  objects were collected during similar time (+/- 20 years) by the same actor?                                                                                                          |                                                                                                                                                                                                                                     | 3526                                                                   | 3526 (0 new object connection found)                                                    | 3542 (16 new object connection found)                                                                                                          | 3549 (23 new object connection found)                                                         |                                |                                |
| CQ-6b     |                                                                                     |                                                                                                                                                                                 | How many objects we can possibly project the time of acquisition based on they are collected by the same actor? (where we do not know the acquisition date, but we do know acquisition for some other object by the same actor) |                                                                                                                                                                                                      |                                                                                                                                                                                                                                     | 40,186                                                                 | 0                                                                                       | 0 (there is no object from bb where we don't know the acquisition date and from the same collector know some acquisition date for nmvw object) | 40,349 / 163 bronbeek objects may get a possible acquisition time                             |                                |                                |
| CQ-6c     |                                                                                     |                                                                                                                                                                                 | How many objects can be connected with one other objects based on they are collected during similar time and from similar location by the same actor?                                                                           | How many objects can be connected with one other objects based on they are collected during similar time by the same actor, therefore can also be (possibly) collected from similar location?        |                                                                                                                                                                                                                                     | 3,295                                                                  | 0 new objects                                                                           | 3309 (14 new objects)                                                                                                                          | 3,316 (21 new objects)                                                                        |                                |                                |
TODO: also add `weighted recall (recall*current number)` next to each algorithm, once the table is completed.